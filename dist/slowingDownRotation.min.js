"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var defaultProperty={currentPlayCount:null,playCount:null,currentIndex:null,stopIndex:null,slowDownStartindex:null,isSlowdown:!1,isPlay:!1,isStop:!1,countTimer:null},defaultSetting={wrapperElement:null,targetElement:null,itemElements:null,speed:100,stopIndex:0,playCount:3,autoStart:!1,stopCallback:function(){},startCallback:function(){},slowDownCallback:function(){}},slowingDownRotation=function(){function e(t){_classCallCheck(this,e),Object.assign(this,{options:Object.assign({},defaultProperty,defaultSetting,t)})}return _createClass(e,[{key:"init",value:function(){this.options.autoStart&&this.start()}},{key:"start",value:function(){var t=this.options;t.countTimer&&clearTimeout(t.countTimer),t.isPlay||(t.isPlay=!0),t.startCallback(),this.roll(t.playCount,t.speed)}},{key:"stop",value:function(){var t=this.options;t.isSlowdown||(t.countTimer&&clearTimeout(t.countTimer),t.stopCallback(),t.itemElements.length>=t.stopIndex&&0<=t.stopIndex&&(t.isSlowdown=!0,t.currentPlayCount=0,this.roll(Math.max(1,Math.ceil(20/t.itemElements.length)),t.speed),t.slowDownCallback()))}},{key:"reset",value:function(){var t=this.options;t.playCount=defaultProperty.playCount,t.currentIndex=defaultProperty.currentIndex,t.slowDownStartindex=defaultProperty.slowDownStartindex,t.isSlowdown=defaultProperty.isSlowdown,t.isStop=defaultProperty.isStop,t.countTimer&&(clearTimeout(t.countTimer),t.countTimer=null)}},{key:"roll",value:function(t,e){var n=this,o=this.options;if(o.currentIndex++,o.currentIndex>=o.itemElements.length&&(o.currentIndex=0,o.currentPlayCount++),o.isSlowdown){if(o.currentPlayCount>t&&o.currentIndex-1===o.stopIndex)return void this.reset();e=Math.floor(e+t*(o.currentIndex*o.currentPlayCount))}else if(o.currentPlayCount>t)return void this.stop();this.output(),o.countTimer=setTimeout(function(){n.roll(t,e)},e)}},{key:"output",value:function(){var t=this.options,e="is-active",n=t.currentIndex-1;n<0&&(n=t.itemElements.length-1),t.itemElements[n].classList.remove(e),t.itemElements[t.currentIndex].classList.add(e)}}]),e}();module.exports=slowingDownRotation;
